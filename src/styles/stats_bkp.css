:root{
  --bg:#f8fafc;--panel:#fff;--ink:#0f172a;--muted:#64748b;--ring:#e2e8f0;--brand:#2563eb;
}

#stats-root .series{border:1px solid var(--ring);background:#fff;border-radius:14px;overflow:hidden;margin-bottom:16px}
#stats-root .s-head{display:flex;gap:12px;align-items:center;padding:12px;cursor:pointer}
#stats-root .s-title{font-weight:700}
#stats-root .progress{flex:1;height:12px;background:var(--bg);border:1px solid var(--ring);border-radius:999px;overflow:hidden}
#stats-root .progress>span{display:block;height:100%;width:0;background:linear-gradient(90deg,#ef4444,#f59e0b,#10b981)}
#stats-root .s-meta{min-width:130px;text-align:right;font-size:12px;color:var(--muted)}
#stats-root .s-body{display:none;border-top:1px solid var(--ring);padding:12px;background:#fbfdff}
#stats-root .series.open .s-body{display:block}

#stats-root .grid{display:grid;gap:16px}
@media(min-width:900px){#stats-root .grid{grid-template-columns:1.2fr .8fr}}

#stats-root .card{border:1px solid var(--ring);background:#fff;border-radius:12px;overflow:hidden;margin-bottom:12px}
#stats-root .card h3{margin:0;font-size:14px;padding:10px;border-bottom:1px solid var(--ring);border-radius:12px 12px 0 0}
#stats-root .card.progression h3{background:#eff6ff;color:#1d4ed8}
#stats-root .card.missing h3{background:#fff7ed;color:#b45309}
#stats-root .card.value h3{background:#ecfeff;color:#0e7490}
#stats-root .card.actions h3{background:#f1f5f9;color:#334155}
#stats-root .card.top h3{background:#f0fdf4;color:#166534}
#stats-root .card .content{padding:10px}

#stats-root .list{display:flex;flex-wrap:wrap;gap:8px}
#stats-root .pill{border:1px solid var(--ring);border-radius:999px;background:#fff;padding:6px 10px;display:inline-flex;gap:6px;align-items:center}
#stats-root .pill--sm{padding:4px 8px;font-size:12px}

#stats-root .toolbar{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:6px}
#stats-root .btn{background:#fff;border:1px solid var(--ring);border-radius:999px;padding:6px 10px;cursor:pointer}
#stats-root .btn[aria-pressed="true"]{background:var(--brand);border-color:var(--brand);color:#fff}

#stats-root .tiles{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:10px}
#stats-root .tile{border:1px solid var(--ring);border-radius:10px;padding:10px;background:#fff;cursor:pointer;transition:box-shadow .2s,border-color .2s}
#stats-root .tile b{display:block;font-size:20px;line-height:1.2;margin-top:4px;font-variant-numeric:tabular-nums;font-feature-settings:"tnum" 1,"lnum" 1}
#stats-root .tile[aria-current="true"]{border-color:var(--brand);box-shadow:0 0 0 2px rgba(37,99,235,.15)}
#stats-root .seg{display:flex;gap:10px;align-items:center;margin-top:6px;flex-wrap:nowrap}
#stats-root .seg .ball{flex:0 0 14px;width:14px;height:14px}
#stats-root .seg span{white-space:nowrap;font-variant-numeric:tabular-nums;font-feature-settings:"tnum" 1,"lnum" 1}
#stats-root .muted{color:var(--muted)}
#stats-root .num{font-variant-numeric:tabular-nums;font-feature-settings:"tnum" 1,"lnum" 1}

#stats-root .chips{display:flex;gap:8px;flex-wrap:wrap}
#stats-root .top-list{display:flex;flex-wrap:wrap;gap:8px}

#stats-root .ball{width:12px;height:12px;border-radius:50%;display:inline-block;border:1px solid rgba(0,0,0,.15);position:relative}
#stats-root .ball::before{content:"";position:absolute;left:0;right:0;top:48%;height:1px;background:rgba(0,0,0,.25)}
#stats-root .ball::after{content:"";position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:4px;height:4px;border-radius:50%;background:#fff;border:1px solid rgba(0,0,0,.2)}
#stats-root .ball.n{background:#ef4444}
#stats-root .ball.r{background:#eab308}
#stats-root .ball.a{background:#3b82f6}

#stats-root .psa-ico{display:inline-block;width:24px;height:12px;border:1px solid var(--ring);border-radius:3px;position:relative;background:linear-gradient(90deg,#ef4444 0 28%,transparent 28%)}
#stats-root .psa-ico::after{content:'PSA';position:absolute;right:3px;top:50%;transform:translateY(-50%);font-size:10px;font-weight:800;letter-spacing:.5px;color:#1f2937}

#stats-root .donut{display:flex;flex-direction:column;align-items:center;gap:6px;margin-top:12px}
#stats-root .mini-legend{display:flex;gap:10px;font-size:12px;color:var(--muted);align-items:center}
#stats-root .mini-legend .ball{width:10px;height:10px}
#stats-root svg.donut{max-width:140px}

/* Stats: honor the hidden attribute even if a display is set */
#stats-root [hidden] { display: none !important; }



/* DARK THEME V2*/

/* ===== Stats — thème néon (dark only) ===== */
.theme-dark #stats-root {
  --panel: rgba(255,255,255,.06);
  --ring:  rgba(255,255,255,.12);
  --ink:   #e6eaf2;
  --muted: #9aa3b2;
  --glow:  0 6px 24px rgba(34,211,238,.18);
}

/* Cartes/stat boxes : verre dépoli + léger glow */
.theme-dark #stats-root .card,
.theme-dark #stats-root .series {
  background: var(--panel);
  border-color: var(--ring);
  backdrop-filter: blur(8px);
  box-shadow: var(--glow);
  border-radius: 14px;
}
.theme-dark #stats-root .card h3 {
  background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.02));
  border-color: var(--ring);
  color: var(--ink);
}

/* En-tête d’une série + méta */
.theme-dark #stats-root .s-head { background: transparent; }
.theme-dark #stats-root .s-title { color: var(--ink); }
.theme-dark #stats-root .s-meta { color: var(--muted); }
.theme-dark #stats-root .s-body  { background: rgba(255,255,255,.04); }

/* Progress bar “néon” (barre de complétion set) */
.theme-dark #stats-root .progress {
  background: rgba(255,255,255,.05);
  border-color: var(--ring);
  height: 12px;
  position: relative;
  overflow: hidden;
}
.theme-dark #stats-root .progress > span {
  background: linear-gradient(90deg, var(--accent), var(--primary));
  box-shadow: 0 0 20px rgba(34,211,238,.35), 0 0 40px rgba(124,58,237,.25);
}

/* Pills / chips */
.theme-dark #stats-root .pill,
.theme-dark #stats-root .btn {
  background: rgba(255,255,255,.06);
  border-color: var(--ring);
  color: var(--ink);
}
.theme-dark #stats-root .pill--sm { color: var(--muted); }
.theme-dark #stats-root .btn[aria-pressed="true"]{
  background: linear-gradient(90deg, var(--accent), var(--primary));
  border-color: transparent; color: #0b1020;
  box-shadow: 0 6px 24px rgba(124,58,237,.28);
}

/* Tuiles KPI (valeur / possédé / doublons) */
.theme-dark #stats-root .tiles .tile{
  background: rgba(255,255,255,.05);
  border-color: var(--ring);
  transition: transform .15s ease, box-shadow .2s ease, border-color .2s ease;
}
.theme-dark #stats-root .tiles .tile:hover{
  transform: translateY(-2px);
  box-shadow: var(--glow);
}
.theme-dark #stats-root .tiles .tile[aria-current="true"]{
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(34,211,238,.2);
}

/* Petites pastilles N/R/A (légères, lisibles sur fond sombre) */
.theme-dark #stats-root .ball { border-color: rgba(255,255,255,.25); }
.theme-dark #stats-root .ball::before { background: rgba(255,255,255,.25); }
.theme-dark #stats-root .ball::after  { background: #0b1020; border-color: rgba(255,255,255,.25); }
.theme-dark #stats-root .ball.n{ background:#ef4444; }
.theme-dark #stats-root .ball.r{ background:#f59e0b; }
.theme-dark #stats-root .ball.a{ background:#22d3ee; }

/* Donut (SVG) — couleurs & glow doux */
.theme-dark #stats-root .donut { color: var(--muted); }
.theme-dark #stats-root .mini-legend { color: var(--muted); }
.theme-dark #stats-root svg.donut .seg-n { stroke:#ef4444; filter: drop-shadow(0 0 6px rgba(239,68,68,.35)); }
.theme-dark #stats-root svg.donut .seg-r { stroke:#f59e0b; filter: drop-shadow(0 0 6px rgba(245,158,11,.35)); }
.theme-dark #stats-root svg.donut .seg-a { stroke:#22d3ee; filter: drop-shadow(0 0 6px rgba(34,211,238,.35)); }

/* PSA badge (si utilisé dans la section stats) */
.theme-dark #stats-root .psa-ico{
  background: linear-gradient(90deg,#ef4444 0 28%, transparent 28%);
  border-color: var(--ring);
  color: var(--ink);
}

/* Listes “manquantes” et “top cartes” */
.theme-dark #stats-root .list,
.theme-dark #stats-root .top-list { color: var(--muted); }
.theme-dark #stats-root .card.top h3,
.theme-dark #stats-root .card.value h3,
.theme-dark #stats-root .card.missing h3,
.theme-dark #stats-root .card.progression h3,
.theme-dark #stats-root .card.actions h3 {
  /* unifie les bandeaux pour éviter les aplats blancs */
  background: linear-gradient(90deg, rgba(34,211,238,.16), rgba(124,58,237,.10));
  color: var(--ink);
}

/* Respecter toujours hidden */
#stats-root [hidden] { display: none !important; }

/* Uniformiser la longueur des barres dans les séries */
#stats-root .s-head{
  display: grid;
  grid-template-columns: var(--label-w, clamp(160px, 22vw, 240px)) 1fr max-content;
  gap: 12px;
  align-items: center;
}

/* Titre : coupe proprement s'il est trop long */
#stats-root .s-title{
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* La barre prend 100% de sa colonne */
#stats-root .progress{ width: 100%; }

/* Meta à droite, largeur mini stable */
#stats-root .s-meta{
  min-width: 130px;
  text-align: right;
}

/* Responsive : en dessous de 640px on passe sur 2 lignes */
@media (max-width: 640px){
  #stats-root .s-head{
    grid-template-columns: 1fr;
    grid-auto-rows: min-content;
  }
  #stats-root .s-meta{ order: 3; }
  #stats-root .progress{ order: 2; }
}

/* === Barre conteneur (fond + léger glow) === */
#stats-root .progress{
  position: relative;
  height: 12px;
  background: rgba(255,255,255,.06);
  border: 1px solid var(--ring);
  border-radius: 999px;
  overflow: hidden;
  box-shadow:
    0 2px 10px rgba(34,211,238,.06) inset,
    0 8px 24px rgba(2,6,23,.35);
}

/* === Remplissage néon + anim === */
#stats-root .progress > span{
  --w: 0%;                      /* cible: sera alimentée en JS */
  width: 0;                     /* démarre vide, animé vers var(--w) */
  height: 100%;
  display: block;
  border-radius: inherit;
  background: linear-gradient(90deg, #22d3ee 0%, #7c3aed 100%);
  box-shadow:
    0 0 0 1px rgba(255,255,255,.06) inset,
    0 0 22px rgba(124,58,237,.35),
    0 0 12px rgba(34,211,238,.25);
  animation: stats-fill 1s cubic-bezier(.2,.8,.2,1) forwards;
  animation-delay: calc(var(--i, 0) * .03s);   /* cascade douce */
  position: relative;
}

/* Shimmer (petit balayage lumineux) */
#stats-root .progress > span::after{
  content:"";
  position:absolute; inset:0;
  background: linear-gradient(90deg, transparent 0 35%,
                              rgba(255,255,255,.35) 50%,
                              transparent 65% 100%);
  transform: translateX(-120%);
  animation: stats-shimmer 1.6s ease-out .15s both;
  pointer-events: none;
}

/* Hover glow */
#stats-root .series:hover .progress > span{
  filter: drop-shadow(0 0 12px rgba(124,58,237,.35))
          drop-shadow(0 0 10px rgba(34,211,238,.25));
}

/* Meta pourcentage colorée par niveau */
#stats-root .s-meta .pct{ font-weight:700 }
#stats-root .s-meta .pct.good{ color:#10b981 }  /* ≥95% */
#stats-root .s-meta .pct.ok{   color:#f59e0b }  /* 70–95% */
#stats-root .s-meta .pct.bad{  color:#ef4444 }  /* <70%  */

/* Animations */
@keyframes stats-fill{
  from{ width: 0 }
  to  { width: var(--w) }
}
@keyframes stats-shimmer{
  0%  { transform: translateX(-120%) }
  60% { transform: translateX(0%) }
  100%{ transform: translateX(120%); opacity: 0 }
}
